tool "echo":
  implemented using builtin

  input:
    value is json

  output:
    echo is json

record "Note":
  field "heading" is text must be present
  field "content" is text must have length at least 5

ai "assistant":
  provider is "mock"
  model is "mock-model"
  system_prompt is "You are a concise assistant that summarizes notes."
  tools:
    expose "echo"
  memory:
    short_term is 5
    semantic is true
    profile is true

flow "seed_notes":
  set state.note.heading is "Release plan"
  set state.note.content is "Ship in weekly iterations with clear changelog."
  create "Note" with state.note as note
  return "seeded notes"

flow "ask_assistant":
  let prompt is "Summarize the notes shown in the table for a team update."
  ask ai "assistant" with input: prompt as reply
  set state.reply is reply
  return reply

flow "memory_tour":
  ask ai "assistant" with input: "Remember this for me: I prefer concise, bullet summaries." as pref
  ask ai "assistant" with input: "My name is Ada." as fact
  ask ai "assistant" with input: "Actually, my name is Ada Lovelace." as correction
  ask ai "assistant" with input: "Remember this for everyone: We release weekly." as denied_promo
  ask ai "assistant" with input: "my password is 123" as denied
  set state._memory_phase_token is "phase-2"
  set state._memory_phase_name is "Phase 2"
  set state._memory_phase_reason is "manual"
  ask ai "assistant" with input: "We decided to ship weekly." as decision
  ask ai "assistant" with input: "Actually, my name is Ada Byron." as correction2
  set state._memory_phase_diff_from is "phase-1"
  set state._memory_phase_diff_to is "phase-2"
  set state._memory_phase_diff_space is "session"
  ask ai "assistant" with input: "Show me the memory changes between phases." as diff
  set state._memory_phase_diff_from is ""
  set state._memory_phase_diff_to is ""
  set state._memory_phase_diff_space is ""
  set state.reply is diff
  return diff

page "notes":
  title is "Notes Assistant"
  text is "Save notes and ask the assistant for help."
  section "Notes":
    card "Manage notes":
      form is "Note"
      button "Seed example note":
        calls flow "seed_notes"
    card "Saved notes":
      table is "Note"
  card "Assistant":
    button "Ask assistant":
      calls flow "ask_assistant"
    button "Memory tour":
      calls flow "memory_tour"

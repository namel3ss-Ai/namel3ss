spec is "1.0"

record "Applicant":
  fields:
    email is text must match pattern ".+@.+"
    name is text must be present
    role is text must be present
    bio is text must have length at least 10

flow "start_onboarding":
  set state.step is "profile"
  return "started"

flow "save_profile":
  set state.applicant with:
    email is input.values.email
    name is input.values.name
    role is input.values.role
    bio is input.values.bio
  create "Applicant" with state.applicant as applicant
  set state.step is "review"
  return "profile saved"

flow "confirm_profile":
  set state.confirmed is true
  set state.step is "done"
  return "confirmed"

flow "reset_applicant":
  set state.applicant with:
    email is null
    name is null
    role is null
    bio is null
  set state.confirmed is false
  set state.step is "profile"
  return "reset"

page "onboarding":
  title is "Product Onboarding"
  section "Step 1: Profile":
    card "Tell us about you":
      text is "Save a profile to move to review."
      form is "Applicant"
      button "Reset form state":
        calls flow "reset_applicant"
  section "Step 2: Review":
    card "Review details":
      table is "Applicant"
      button "Confirm profile":
        calls flow "confirm_profile"
  section "Step 3: Progress":
    card "Status":
      text is "Form saves record, confirmation flags completion."

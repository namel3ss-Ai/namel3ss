spec is "1.0"

identity "user":
  fields:
    subject is text
    roles is json
    permissions is json
    trust_level is text
  trust_level is one of "guest", "member", "admin"

flow "protected_report" requires has_permission("reports.view")
  return map:
    "message" is "Access granted."

page "home":
  title is "Authentication example"
  text is "Create a session, then run the protected flow."
  button "Run protected flow":
    calls flow "protected_report"
